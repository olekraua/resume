# --- App ---
spring.application.name=resume
spring.profiles.default=dev

# PostgreSQL
spring.datasource.url=jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:resume_db}
spring.datasource.username=${DB_USERNAME:resume}
spring.datasource.password=${DB_PASSWORD:1234}

spring.data.mongodb.uri=mongodb://localhost:27017/resume

#Spring Security
spring.security.user.name=${APP_ADMIN:user}
spring.security.user.password=${APP_PASSWORD:1234}
# Remember-me (set REMEMBER_ME_KEY in prod)
app.security.remember-me.key=${REMEMBER_ME_KEY:resume-remember-me-key}
app.security.remember-me.token-ttl=PT336H
app.security.remember-me.parameter=remember-me
app.security.remember-me.cookie-name=remember-me

# JPA-Konfiguration
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=true
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.use_query_cache=true
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.jcache.internal.JCacheRegionFactory
spring.jpa.properties.hibernate.javax.cache.missing_cache_strategy=create
spring.flyway.baseline-on-migrate=true
spring.flyway.baseline-version=0
spring.flyway.enabled=true

# Cache (Caffeine)
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=5000,expireAfterAccess=1h
# Spring Data repos: disable auto-config scanning to avoid multi-store warnings (explicit config in RepositoryConfig)
spring.data.jpa.repositories.enabled=false
spring.data.elasticsearch.repositories.enabled=false
# Toggle Elasticsearch integration (set to false to run without ES, e.g. in tests)
app.search.elasticsearch.enabled=true
# Expose search query endpoints
app.search.query-api.enabled=true
# Privacy controls for Elasticsearch indexing (to reduce personal data stored in ES)
app.search.elasticsearch.privacy.index-info=true
app.search.elasticsearch.privacy.redact-info=true

# ===============================
# REST-ONLY BACKEND
# ===============================
spring.thymeleaf.enabled=false
spring.freemarker.enabled=false
spring.web.resources.add-mappings=false

# ===============================
# FILE UPLOAD
# ===============================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=15MB

# ===============================
# I18N / MESSAGES
# ===============================
spring.messages.basename=i18n.messages
spring.messages.encoding=UTF-8
spring.messages.cache-duration=3600

# ===============================
# VALIDATION
# ===============================
# Boot automatically wires Hibernate Validator (Jakarta Validation)
# Messages are read from i18n.messages

# ===============================
# ERROR HANDLING (custom Handler support)
# ===============================
server.error.include-message=always
server.error.include-binding-errors=always

# ===============================
# LOGGING
# ===============================
logging.level.root=INFO
logging.level.org.springframework.web=INFO
logging.level.net.devstudy.resume=DEBUG

# ===============================
# ACTUATOR
# ===============================
management.endpoints.web.exposure.include=health,info
management.endpoint.health.probes.enabled=true
app.restore.show-link=false
app.restore.token-ttl=PT1H
app.restore.mail.enabled=true
app.restore.mail.from=ksanya7@gmail.com
app.restore.mail.subject=Відновлення доступу
app.restore.mail.template.text=classpath:/mail/restore-access.txt.ftl
app.restore.mail.template.html=classpath:/mail/restore-access.html.ftl

# --- Mail (SMTP) ---
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${SMTP_USER}
spring.mail.password=${SMTP_PASS}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# ===============================
# DEVTOOLS (when spring-boot-devtools is on classpath)
# ===============================
spring.devtools.livereload.enabled=true
spring.devtools.restart.enabled=true

# --- Profile / Hobbies ---
profile.hobbies.max=5

uid.max-tries=20
uid.suffix.alphabet=abcdefghijklmnopqrstuvwxyz0123456789
uid.suffix.length=2


# --- Threading (safe defaults; override per host) ---
spring.threads.virtual.enabled=${APP_VIRTUAL_THREADS:false}

# --- Task Executor (used by @Async) ---
spring.task.execution.pool.core-size=${APP_TASK_CORE_SIZE:2}
spring.task.execution.pool.max-size=${APP_TASK_MAX_SIZE:2}

# --- Media threading (parallel image optimization) ---
media.threading.parallel-enabled=${MEDIA_THREADING_PARALLEL_ENABLED:true}
# pool-size=0 -> auto (1..4 based on CPU count)
media.threading.pool-size=${MEDIA_THREADING_POOL_SIZE:0}
media.threading.queue-capacity=${MEDIA_THREADING_QUEUE_CAPACITY:100}
media.threading.shutdown-timeout-seconds=${MEDIA_THREADING_SHUTDOWN_TIMEOUT_SECONDS:30}

# --- Medien & Tools (macOS-freundlich) ---
media.storage.root-path=${user.home}/resume-media
# Intel Homebrew:
media.optimization.jpegtran=/opt/homebrew/bin/jpegtran
# Apple Silicon Homebrew (Alternative):
# media.optimization.jpegtran=/opt/homebrew/bin/jpegtran

# --- Notifications aus dem Classpath (statt /WEB-INF) ---
notification.config.path=classpath:/notifications/notifications.xml

# --- Elasticsearch (REST client) ---
spring.elasticsearch.uris=http://localhost:9200

# --- Social (aus Umgebungsvariablen laden, nicht committen) ---
social.facebook.client-id=${FACEBOOK_CLIENT_ID}
social.facebook.client-secret=${FACEBOOK_CLIENT_SECRET}

# Server
server.port=8080
