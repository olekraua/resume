<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="utf-8">
    <title th:text="|${profile.firstName} ${profile.lastName}|">
        Profile
    </title>
</head>

<body>
    <div style="display: flex; justify-content: flex-end; padding: 12px;" sec:authorize="isAuthenticated()">
        <form th:action="@{/logout}" method="post" style="margin: 0;">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <button type="submit" style="padding: 8px 14px; border: 1px solid #dc3545; border-radius: 4px; color: #dc3545; background: transparent; cursor: pointer;">Вийти</button>
        </form>
    </div>
    <div th:if="${ownProfile}" style="max-width: 320px; padding: 12px; border: 1px solid #ddd; border-radius: 6px; margin-bottom: 16px;">
        <h3 style="margin-top: 0;">Змінити ім'я користувача</h3>
        <form th:action="@{/account/login}" th:object="${changeLoginForm}" method="post">
            <div style="margin-bottom: 8px;">
                <label for="newUid">Новий логін (uid)</label><br>
                <input id="newUid" th:field="*{newUid}" type="text" required style="width: 100%; padding: 6px;">
                <small>Поточний: <span th:text="${currentUid}">current</span></small>
                <div th:if="${#fields.hasErrors('newUid')}" style="color: #b71c1c;" th:errors="*{newUid}">Помилка</div>
            </div>
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <div th:if="${errorMessage}" style="color: #b71c1c; margin-bottom: 8px;" th:text="${errorMessage}"></div>
            <button type="submit" style="padding: 8px 12px;">Змінити логін</button>
        </form>
    </div>
    <div th:id="'profile-' + ${profile.id}" class="row profile">
        <div>
            <h2 th:text="${profile.firstName + ' ' + profile.lastName}">John </h2>
        </div>
    </div>
</body>

</html>
